"use strict";var __importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0});const utilityFunctionsServer_1=require("../utilityFunctionsServer"),cartUtils_1=require("../controllers/cartUtils"),errorUtils_1=require("../utils/errorUtils"),userUtils_1=require("../controllers/userUtils"),validate_1=__importDefault(require("../microservices/product/middleware/validate"));async function cartData(request,response){var _a,_b;try{const validValues=(0,utilityFunctionsServer_1.getValidValues)(request.body),user=validValues.user,cart=validValues.cart,token=validValues.token;let result;validate_1.default.cart(cart),cart._id=await(0,userUtils_1.getCartId)(user,token);const item=validValues.item,item_ids=null===(_b=null===(_a=null==request?void 0:request.body)||void 0===_a?void 0:_a.cart)||void 0===_b?void 0:_b.item_ids;item?result=await(0,cartUtils_1.updateCart)(cart,item):item_ids&&(result=await(0,cartUtils_1.setCart)(cart,item_ids)),response.status(200).send(result)}catch(asyncError){const{error:error,message:message,code:code}=await(0,errorUtils_1.handleAsyncError)(asyncError);response.status(code).send(message)}}exports.default={cartData:cartData};