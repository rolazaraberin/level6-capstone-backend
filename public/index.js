(()=>{"use strict";var e={4334:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getAccountById=t.getAccountByToken=t.deleteAccountById=t.deleteAccountByToken=t.deleteAccountByPassword=t.createAccountByGoogle=t.createAccountByPassword=void 0;const o=n(2553),i=r(n(126)),a=n(7846),s=r(n(7825)),u=n(921);async function c(e,t,n){await(0,o.deleteCartById)(e),await(0,a.deleteLoginByEmail)(t),await(0,u.deleteUserById)(n)}async function d(e){const t=await(0,u.getUserById)(e);return t.cart=await(0,o.getCartById)(t.cart_id),t}t.createAccountByPassword=async function(e,t){const n=await(0,u.createUserByEmail)(e);await(0,a.createLoginByPassword)(e,t,n);const r=i.default.getNew(e);return await i.default.save(e,r),{user:n,token:r}},t.createAccountByGoogle=async function(e,t,n){const r=await(0,u.createUserByEmail)(e,t);await(0,a.createLoginByGoogle)(e,r._id,n);const o=i.default.getNew(e);return await i.default.save(e,o),{user:r,token:o}},t.deleteAccountById=async function(e){const t=await(0,u.getUserById)(e);if(!t){const e=new Error("ERROR: invalid user id");throw e.code=s.default.error.badRequest,e}await c(t.cart_id,t.email,e)},t.deleteAccountByPassword=async function(e,t){const n=await(0,u.getUserByPassword)(e,t);if(!n){const e=new Error("ERROR: incorrect password");throw e.code=s.default.error.incorrectPassword,e}await c(n.cart_id,e,n._id)},t.deleteAccountByToken=async function(e,t){const n=await(0,u.getUserByToken)(e,t);if(!n){const e=new Error("ERROR: invalid token");throw e.code=s.default.error.incorrectCredentials,e}await c(n.cart_id,e,n._id)},t.getAccountByToken=async function(e,t){const n=await(0,u.getUserByToken)(e,t),r=await d(n._id);return r&&(r.token=t),r},t.getAccountById=d},3585:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7825)),i=n(921),a={ping:async function(e,t){try{const e={};await(0,i.getUserById)(e),t.send("API ready")}catch(e){const n=await e;n.message="ERROR: API not ready. Try again.";const r=o.default.error.serverError;t.status(r).send(n)}}};t.default=a},380:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7825)),i=n(9577),a=n(2433),s=r(n(1043)),u={cart:async function(e,t,n){if(!e)throw new Error("ERROR: invalid cart id");const r=await u.token(t.email,n),{user_id:i}=r;if(t._id!==i){const e=new Error("ERROR: forbidden access to cart");throw e.code=o.default.error.forbiddenUser,e}},password:async function(e,t){if(!e||!t){const e=new Error("ERROR: email and password must be provided");throw e.code=o.default.error.unauthenticated,e}const n=(0,i.hash)(e),r=(0,i.hash)(t),a=await s.default.getOne({emailHash:n,passwordHash:r});if(!a){const e=new Error("ERROR: Incorrect email or password");throw e.code=o.default.error.unauthenticated,e}const{user_id:u,token:c}=a;return{user_id:u,token:c}},token:async function(e,t){if((0,a.isEmpty)(e)||(0,a.isEmpty)(t)){const e=new Error("ERROR: incorrect email or token");throw e.code=o.default.error.unauthenticated,e}const n=(0,i.hash)(e);if(!n){const e=new Error("ERROR: Invalid email or token");throw e.code=o.default.error.unauthenticated,e}return await s.default.getOne({emailHash:n,token:t})},google:async function(e,t){if((0,a.isEmpty)(e)||(0,a.isEmpty)(t)){const e=new Error("ERROR: incorrect email or id");throw e.code=o.default.error.unauthenticated,e}const n=(0,i.hash)(e);if(!n){const e=new Error("ERROR: Invalid email or token");throw e.code=o.default.error.unauthenticated,e}const r=await s.default.getOne({emailHash:n,googleId:t});if(!r){const e=new Error("ERROR: An account with that email was not found.");throw e.code=o.default.error.unauthenticated,e}return r}};t.default=u},2553:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateCart=t.setCart=t.removeItemFromCart=t.getItemsByCart=t.createCart=t.deleteCartById=t.getCartByUser=t.getCartByToken=t.getCartById=void 0;const o=n(921),i=r(n(8402)),a=r(n(6886)),s=r(n(6368)),u=n(2433);async function c(e){s.default.cart_id(e);const t=await i.default.getOne({_id:e});if(!t)throw new Error("ERROR: Unable to get cart by id");return s.default.cart(t),t.items=await d(t),t}async function d(e){const{item_ids:t}=e;return(0,u.isEmpty)(t)?[]:await a.default.getOne({_id:{$all:e.item_ids}})}t.getCartById=c,t.getCartByToken=async function(e,t){const n=await(0,o.getUserByToken)(e,t);return await c(n.cart_id)},t.getCartByUser=async function(e){const t=e.cart_id;if(!t)throw new Error("ERROR: missing user cart information");return await c(t)},t.deleteCartById=async function(e){return await c(e),await i.default.deleteOne({_id:e})},t.createCart=async function(){return(await i.default.addOne()).insertedId},t.getItemsByCart=d,t.removeItemFromCart=async function(e,t){s.default.cart(e),s.default.item(t);const n={_id:e._id,$pull:{items:t._id}};return await i.default.updateOne(n),await c(null==e?void 0:e._id)},t.setCart=async function(e,t){const n=Object.assign(Object.assign({},e),{item_ids:t});return await i.default.updateOne(n),"SUCCESS: cart updated"},t.updateCart=async function(e,t){const{item_ids:n}=e,{_id:r}=t,o=Object.assign({},e);return await i.default.updateOne(o),await c(e._id)}},126:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2433),i=n(9577),a=r(n(1043)),s={invalidate:async function(e){const t={_id:e,token:""};return await a.default.updateOne(t)},revoke:async function(e){const t={_id:e,token:"",accessToken:"",revokeToken:""};return await a.default.updateOne(t)},getNew:function(e){return(0,i.hash)(e+(0,o.generateKey)())},save:async function(e,t,n,r){const o=(0,i.hash)(e),s=await a.default.getOne({emailHash:o}),{_id:u}=s,c={_id:u,token:t};return n&&(c.accessToken=n),r&&(c.revokeToken=r),await a.default.updateOne(c)}};t.default=s},4321:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.restoreDependencies=t.injectDependencies=t.getInventory=void 0;const o=r(n(9176)),i=n(2373);let a=o.default;t.getInventory=async function(){const e=await a.getOne(),t=await(0,i.getItemsById)(e.item_ids);return Object.assign(Object.assign({},e),{items:t})},t.injectDependencies=function(e,t){a=e,(0,i.injectDependency)(t)},t.restoreDependencies=function(){a=o.default,(0,i.restoreDependency)()}},2373:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.restoreDependency=t.injectDependency=t.getVerifiedItemId=t.getItemsById=t.getItemById=void 0;const o=n(2433),i=r(n(6886));let a=i.default;t.getItemById=async function(e){return await a.getOne({_id:e})},t.getItemsById=async function(e){if((0,o.isEmpty)(e))throw new Error("ERROR: item ids are required");let t={_id:{$in:e}};return await a.getMany(t)},t.getVerifiedItemId=async function(){return(await a.getOne())._id},t.injectDependency=function(e){a=e},t.restoreDependency=function(){a=i.default}},6270:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(380)),i=r(n(126)),a=n(56),s=r(n(7477)),u={withToken:async function(e,t,n){const{email:r,token:i}=e.body;if(!i)return n();try{const e=await o.default.token(r,i);if(!e)return t.status(401).send("ERROR: Invalid email or token");const n={email:r,token:i,isTemporary:!1,googleId:e.googleId};t.status(200).send(n)}catch(e){const{error:n,code:r,message:o}=await(0,a.handleAsyncError)(e);t.status(r).send(o)}},withPassword:async function(e,t){const{email:n,password:r}=e.body;try{s.default.loginAttempts(n);const{token:e}=await o.default.password(n,r),a={email:n,token:e,isTemporary:!1};e||(a.token=i.default.getNew(n),await i.default.save(n,a.token)),t.status(200).send(a)}catch(e){const{error:n,code:r,message:o}=await(0,a.handleAsyncError)(e);t.status(r).send(o)}},withGoogle:async function(e,t,n){try{const{email:r,googleId:a}=e.body;if(!a)return n();const{token:s}=await o.default.google(r,a),u={email:r,token:s,isTemporary:!1};s||(u.token=i.default.getNew(r),await i.default.save(r,u.token)),t.status(200).send(u)}catch(e){const{error:n,code:r,message:o}=await(0,a.handleAsyncError)(e);t.status(r).send(o)}}};t.default=u},7846:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.loginWithToken=t.loginWithPassword=t.deleteLoginByEmail=t.getUserIdByPassword=t.createLoginByGoogle=t.createLoginByPassword=void 0;const o=n(9577),i=r(n(126)),a=r(n(185)),s=r(n(7477)),u=r(n(1043)),c=r(n(2216)),d=n(921);t.createLoginByPassword=async function(e,t,n){a.default.email(e),a.default.password(t),a.default.user(n,"ERROR: user is required"),await s.default.signupEmail(e);const r=(0,o.hash)(e),i=(0,o.hash)(t),c=n._id;return await u.default.addOne({emailHash:r,passwordHash:i,user_id:c})},t.createLoginByGoogle=async function(e,t,n){a.default.email(e),a.default.userId(t,"ERROR: userId is required"),await s.default.signupEmail(e);const r=(0,o.hash)(e);return await u.default.addOne({emailHash:r,user_id:t,googleId:n})},t.deleteLoginByEmail=async function(e){a.default.email(e);const t=(0,o.hash)(e);return await u.default.deleteOne({emailHash:t})},t.getUserIdByPassword=async function(e,t){a.default.email(e),a.default.password(t);const n=(0,o.hash)(e),r=(0,o.hash)(t),i=await u.default.getOne({emailHash:n,passwordHash:r});return null==i?void 0:i.user_id},t.loginWithPassword=async function(e,t){a.default.email(e),a.default.password(t);const n=(0,o.hash)(e),r=(0,o.hash)(t),s=await u.default.getOne({emailHash:n,passwordHash:r});let d=null==s?void 0:s.token;d||(d=i.default.getNew(e),await i.default.save(e,d));const l=await c.default.getOne({_id:s.user_id});if(!l)throw new Error("ERROR: invalid login");return{user:l,token:d}},t.loginWithToken=async function(e,t){a.default.email(e),a.default.token(t);const n=(0,o.hash)(e),r=await u.default.getOne({emailHash:n,token:t});if(!r)throw new Error("ERROR: invalid login");const{user_id:i}=r;return await(0,d.getUserById)(i)}},3986:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(380)),i=r(n(126)),a=n(56),s={withToken:async function(e,t){try{const{email:n,token:r}=e.body,a=await o.default.token(n,r),{_id:s}=a;await i.default.invalidate(s),t.status(200).send("SUCCESS: logged out")}catch(e){const{error:n,code:r,message:o}=await(0,a.handleAsyncError)(e);t.status(r).send(o)}}};t.default=s},3215:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(2139)),i=r(n(5142)),a=n(56);i.default.config();const s={signupConfirmation:function(e){c(e)||u({from:"rolazaraberin.test@gmail.com",to:e,subject:"Signup Confirmation",text:`${e} has been signed up for Online Store`,html:`<p>${e} has been signed up for Online Store</p>`})},deleteConfirmation:function(e){c(e)||u({from:"rolazaraberin.test@gmail.com",to:e,subject:"Delete Confirmation",text:`${e} has been deleted from Online Store`,html:`<p>${e} has been deleted from Online Store</p>`})}};async function u(e){try{return(await o.default.send(e))[0].statusCode}catch(e){const{error:t,code:n,message:r}=await(0,a.handleAsyncError)(e);console.log(t)}}function c(e){switch(e){case"new@email.com":case"temp@email.com":case"temporary@email.com":case"correct@email.com":case"permanent@email.com":return!0}return!1}t.default=s,o.default.setApiKey(process.env.sendGridApiKey)},155:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3215)),i=r(n(5142)),a=n(4334),s=n(56),u=r(n(7477)),c={withPassword:async function(e,t,n){try{const{email:n,password:r}=e.body;await u.default.signupEmail(n);const{user:i,token:s}=await(0,a.createAccountByPassword)(n,r);t.status(200).send({email:i.email,token:s}),"true"!==d&&o.default.signupConfirmation(n)}catch(e){const{error:n,code:r,message:o}=await(0,s.handleAsyncError)(e);t.status(r).send(o)}},withGoogle:async function(e,t,n){try{const{email:r,name:i,googleId:s}=e.body;if(!s)return n();await u.default.signupEmail(r);const{user:c,token:l}=await(0,a.createAccountByGoogle)(r,i,s);t.status(200).send({email:c.email,token:l}),"true"!==d&&o.default.signupConfirmation(r)}catch(e){const{error:n,code:r,message:o}=await(0,s.handleAsyncError)(e);t.status(r).send(o)}}};t.default=c,i.default.config();const d=process.env.disableEmails},6416:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(3215)),i=r(n(5142)),a=n(56),s=n(4334),u={fetchInfo:async function(e,t){try{const{email:n,token:r}=e.body,o=await(0,s.getAccountByToken)(n,r);if(!o)return t.status(401).send("ERROR: Cannot retrieve account");t.status(200).send(o)}catch(e){const{error:n,message:r,code:o}=await(0,a.handleAsyncError)(e);t.status(o).send(r)}},delete:async function(e,t){try{const{email:n,password:r,token:i}=e.body;r?await(0,s.deleteAccountByPassword)(n,r):i&&await(0,s.deleteAccountByToken)(n,i),t.status(200).send("SUCCESS: Account deleted"),"true"!==c&&o.default.deleteConfirmation(n)}catch(e){const{error:n,message:r,code:o}=await(0,a.handleAsyncError)(e);t.status(o).send(r)}}};t.default=u,i.default.config();const c=process.env.disableEmails},921:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deleteUserById=t.getUserByPassword=t.getUserByToken=t.getUserById=t.getCartId=t.createUserByEmail=void 0;const o=n(9577),i=n(7846),a=n(2553),s=r(n(7825)),u=r(n(185)),c=r(n(2216)),d=r(n(1043));async function l(e){try{if(!e)throw new Error("ERROR: user id is required");return await c.default.getOne({_id:e})}catch(e){}}async function f(e,t){u.default.email(e),u.default.token(t);const n=(0,o.hash)(e),r=await d.default.getOne({emailHash:n,token:t}),i=await c.default.getOne({_id:r.user_id});if(!i)throw new Error("ERROR: Unable to get user by token");return i}t.getCartId=async function(e,t){const{email:n,cart_id:r}=e;if(r)return r;const o=await f(n,t);return null==o?void 0:o.cart_id},t.getUserById=l,t.getUserByToken=f,t.getUserByPassword=async function(e,t){u.default.email(e),u.default.password(t);const n=await(0,i.getUserIdByPassword)(e,t);if(!n){const e=new Error("ERROR: invalid email or password");throw e.code=s.default.error.incorrectCredentials,e}return await l(n)},t.deleteUserById=async function(e){try{if(!e)throw new Error("ERROR: user id is required");return await c.default.deleteOne({_id:e})}catch(e){throw new Error("ERROR: must delete user cart and user login before deleting user")}},t.createUserByEmail=async function(e,t=""){u.default.email(e);const n={};n.email=e,n.name=t,n.cart_id=await(0,a.createCart)();const r=await c.default.addOne(n);return n._id=r.insertedId,n}},9124:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handler=void 0,n(3236);const o=r(n(6860)),i=r(n(3582)),a=r(n(8823)),s=(r(n(5734)),r(n(3309)),n(4321),n(8347)),u=r(n(724)),c=r(n(5142)),d=n(2636),l=n(6935),f=n(8240);c.default.config();const y=(0,o.default)(),p=(0,l.getHost)("localhost"),h=(0,d.getPort)(8e3);process.env.hostEnvironment,y.use((0,i.default)({origin:"*"})),y.use(o.default.static("public")),y.use(o.default.json()),y.use("/",a.default),(0,f.isServerless)()||(console.log("Starting server..."),y.listen(h,p,(function(){(0,s.isDockerEnvironment)()?console.log(`Listening on http://localhost:${h}`):console.log(`Listening on http://${p}:${h}`)}))),t.handler=(0,u.default)(y)},8395:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MICROSERVICES=void 0;const r=n(1730),o=n(9237);t.MICROSERVICES={customer:r.CONTROLLERS,product:o.CONTROLLERS}},1730:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CONTROLLERS=void 0;const o=r(n(1043)),i=r(n(2216));t.CONTROLLERS={login:o.default,user:i.default}},1043:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const o=n(1272),i=n(2433),a=o.mongodb.getCollection("login"),s={getOne:async function(e){return await a,(0,i.isEmpty)(e)?null:await a.findOne(e)||null},addOne:async function(e){return await a,await a.insertOne(e)},updateOne:async function(e){await a;let{_id:t}=e,n=r(e,["_id"]);if(!t)throw new Error("ERROR: _id is required");return await a.updateOne({_id:t},{$set:n})},deleteOne:async function(e){if(await a,(0,i.isEmpty)(e))throw new Error("ERROR: Unable to delete login");return await a.deleteOne(e)}};t.default=s},2216:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(1272),a=o(n(185)),s=n(2433),u=n(8013),c={getOne:async function(e){if(await d,(0,s.isEmpty)(e))return null;let{_id:t}=e;if(!t)throw new Error("ERROR: User ID is required");return"string"==typeof t&&(t=new u.ObjectId(t)),await d.findOne({_id:t})},addOne:async function(e){await d;const{email:t}=e;return a.default.email(t),await d.insertOne(e)},deleteOne:async function(e){return await d,await d.deleteOne(e)},updateOne:async function(e){await d;let{_id:t}=e,n=r(e,["_id"]);if(!t)throw new Error("ERROR: _id is required");return await d.updateOne({_id:t},{$set:n})}};t.default=c;const d=i.mongodb.getCollection("user")},185:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7825)),i={email:function(e){if(!e)throw new Error("ERROR: email is required");if("string"!=typeof e)throw new Error("ERROR: invalid email")},password:function(e){if(!e)throw new Error("ERROR: password is required");if("string"!=typeof e)throw new Error("ERROR: invalid password")},user:function(e,t="ERROR: invalid user"){if(!e||!e._id){const e=new Error(t);throw e.code=o.default.error.badRequest,e}},userId:function(e,t="ERROR: invalid user id"){if(!e){const e=new Error(t);throw e.code=o.default.error.badRequest,e}},token:function(e){if(!e)throw new Error("ERROR: token is required");if("string"!=typeof e)throw new Error("ERROR: invalid token")}};t.default=i},7477:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(9577),i=r(n(185)),a=r(n(1043)),s={signupEmail:async function(e){i.default.email(e);const t=(0,o.hash)(e);if(await a.default.getOne({emailHash:t}))throw new Error("ERROR: An account with that email already exists")},loginAttempts:function(e){var t;const n=null!==(t=u[e])&&void 0!==t?t:0;if(n>3)throw new Error("ERROR: Too many login attempts");u[e]=n+1,function(e){clearTimeout(c[e]),c[e]=setTimeout((()=>{clearTimeout(c[e]),u[e]=0}),d)}(e)}};t.default=s;const u={},c={},d=6e4},1272:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.mongodb=t.sql=t.typeorm=t.knex=void 0;const o=r(n(457)),i=r(n(3794)),a=new o.default;a.configureMongodb(i.default),t.knex=a.knex,t.typeorm=a.typeorm,t.sql=a.sql,t.mongodb=a.mongodb},3794:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5142)).default.config();const o=process.env.mongodbConnectionString;console.log("CONNECTION STRING: ",o);const i=process.env.mongodbDatabase;if(console.log("DATABASE: ",i),!o)throw new Error("ERROR: Mongodb connection string is required");if(!i)throw new Error(`CONNECTION STRING: ${o}\nDATABASE: ${i}`);const a={connectionString:o,database:i,user:process.env.mongodbUser,password:process.env.mongodbPassword};t.default=a},9237:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CONTROLLERS=void 0;const o=r(n(8402)),i=r(n(6886)),a=r(n(9176));t.CONTROLLERS={cart:o.default,item:i.default,inventory:a.default}},8402:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2303),i=n(2433),a=n(8013),s={addOne:async function(e){return await u,e||(e={}),await u.insertOne(e)},getOne:async function(e){if(await u,(0,i.isEmpty)(e))return null;const{_id:t}=e;if(!t)throw new Error("ERROR: Cart id is required");return await u.findOne({_id:new a.ObjectId(t)})},deleteOne:async function(e){if(await u,(0,i.isEmpty)(e))throw new Error("ERROR: Unable to delete cart");return await u.deleteOne(e)},updateOne:async function(e){await u;let{_id:t}=e,n=r(e,["_id"]);if(!t)throw new Error("ERROR: _id is required");return await u.updateOne({_id:t},{$set:n})}};t.default=s;const u=o.mongodb.getCollection("cart")},3309:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7149)),i=n(8655),a={getOne:async function(e){var t,n,r;const i=await o.default.send('\n    query {\n      amazonProductCategory(input: {categoryId: "1084128"}) {\n        productResults {\n          results{\n            asin\n            title\n            mainImageUrl\n            price {\n              value\n            }\n          }\n        }\n      }\n    }'),a=(null===(r=null===(n=null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.amazonProductCategory)||void 0===n?void 0:n.productResults)||void 0===r?void 0:r.results).map(s);return{item_ids:a.map(u),items:a}}};function s(e){const t=e.asin,{name:n,description:r}=function(e){const[t,...n]=e.split(",");return{name:t,description:e}}(e.title),o=e.price.value,a=e.mainImageUrl;return(0,i.Item)({_id:t,name:n,description:r,price:o,image:a})}function u(e){const{_id:t}=e;return t}t.default=a},9176:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2303),i={getOne:async function(e){return await a,await a.findOne(e)},updateOne:async function(e){await a;let{_id:t}=e,n=r(e,["_id"]);if(!t)throw new Error("ERROR: _id is required");return await a.updateOne({_id:t},{$set:n})}};t.default=i;const a=o.mongodb.getCollection("inventory")},5734:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7149)),i=n(8655),a=r(n(3309)),s={getOne:async function(e){var t;let{_id:n}=e||{};n||(n="B0BDHWDR12");const r=`\n    query amazonProduct {\n      amazonProduct(input: { asinLookup: { asin: "${n}" } }) {\n        asin\n        title\n        mainImageUrl\n        price {\n          value\n        }\n      }\n    }`,a=await o.default.send(r),s=null===(t=null==a?void 0:a.data)||void 0===t?void 0:t.amazonProduct;return s?(s.asin=n,function(e){const t=e.asin,{name:n,description:r}=function(e){const[t,...n]=e.split(",");return{name:t,description:e}}(e.title),o=e.price.value,a=e.mainImageUrl;return(0,i.Item)({_id:t,name:n,description:r,price:o,image:a})}(s)):null},getMany:async function(e){var t;const n=await a.default.getOne(),{items:r}=n,o=(null===(t=null==e?void 0:e._id)||void 0===t?void 0:t.$in)||[];return r.filter((i=o,function(e){const t=`${e._id}`;return i.includes(t)}));var i}};t.default=s},6886:function(e,t,n){var r=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};Object.defineProperty(t,"__esModule",{value:!0});const o=n(2303),i={getOne:async function(e){return await a,await a.findOne(e)},getMany:async function(e){return await a,await a.find(e).toArray()},updateOne:async function(e){await a;let{_id:t}=e,n=r(e,["_id"]);if(!t)throw new Error("ERROR: _id is required");return await a.updateOne({_id:t},{$set:n})}};t.default=i;const a=o.mongodb.getCollection("item")},6368:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(7825)),i={cart:function(e){if(!e||!e._id){const e=new Error("ERROR: invalid cart");throw e.code=o.default.error.badRequest,e}},cart_id:function(e){if(!e){const e=new Error("ERROR: invalid cart");throw e.code=o.default.error.badRequest,e}},item:function(e){if(!e||!e._id){const e=new Error("ERROR: invalid item");throw e.code=o.default.error.badRequest,e}}};t.default=i},2303:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.mongodb=t.sql=t.typeorm=t.knex=void 0;const o=r(n(457)),i=r(n(2050)),a=new o.default;a.configureMongodb(i.default);const{knex:s,typeorm:u,sql:c,mongodb:d}=a;t.knex=s,t.typeorm=u,t.sql=c,t.mongodb=d},8655:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Item=void 0;const o=n(2433),i=r(n(8535));t.Item=e=>{if((0,o.isEmpty)(e))return null;const t=Object.assign({},e),{_id:n,name:r,price:a,image:s,description:u}=t;return n&&(t._id=i.default.objectId(n)),r&&(t.name=i.default.string(r)),a&&(t.price=i.default.number(a)),s&&(t.image=i.default.string(s)),u&&(t.description=i.default.string(u)),t}},7149:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5142)).default.config();const o={send:async function(e){return(await fetch("https://graphql.canopyapi.co/",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","API-KEY":i},body:JSON.stringify({query:e})})).json()}};t.default=o;const{canopyApiKey:i}=process.env},2050:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),r(n(5142)).default.config();const o=process.env.mongodbConnectionString,i=process.env.mongodbDatabase;if(!o)throw new Error("ERROR: Mongodb connection string is required");if(!i)throw new Error("ERROR: Mongodb database is required");const a={connectionString:o,database:i,user:process.env.mongodbUser,password:process.env.mongodbPassword};t.default=a},1991:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValidatedQuery=void 0;const r=n(182),o=n(2433);t.ValidatedQuery=function(e){return function(e){if((0,o.isEmpty)(e))return null;const t=Object.assign({},e),n=Object.getOwnPropertyNames(e),r=n.filter((e=>!e.includes("_option"))),i=n.filter((e=>e.includes("_option")));for(let e of i){const n=e.split("_")[0];r.find((e=>e===n))||delete t[e]}return t}((0,r.removeEmptyValues)(e))}},7881:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(56),i=r(n(380)),a={token:async function(e,t,n){try{const{email:t,token:r}=e.body.user;return await i.default.token(t,r),n()}catch(e){const{error:n,code:r,message:i}=await(0,o.handleAsyncError)(e);t.status(r).send(i)}}};t.default=a},8535:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(1991),o=n(8013),i={query:function(e){return(0,r.ValidatedQuery)(e)},number:function(e){const t=Number(e);return"number"==typeof t?t:e},objectId:function(e){if(e instanceof o.ObjectId)return e;try{return new o.ObjectId(e)}catch(t){return e}},string:function(e){return"string"==typeof e?e:`${e}`},array:function(e){return e}};t.default=i},5634:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(3775),i=n(2553),a=n(56),s=n(921),u=r(n(6368));t.default={cartData:async function(e,t){try{const n=(0,o.getValidValues)(e.body),r=n.cart,a=n.item,c=n.user,d=n.token;u.default.cart(r),u.default.item(a),r._id=await(0,s.getCartId)(c,d);const l=await(0,i.removeItemFromCart)(r,a);t.status(200).send(l)}catch(e){const{error:n,message:r,code:o}=await(0,a.handleAsyncError)(e);t.status(o).send(r)}}}},2062:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.urls=t.hostUrl=t.endpoints=void 0,t.endpoints={baseUrl:"/",api:"/api",cart:"/api/cart",inventory:"/api/inventory",login:"/api/login",logout:"/api/logout",signup:"/api/signup",user:"/api/user",test:"/test",redirect:"/api/auth/redirect",callback:"/api/auth/callback",refresh:"/api/auth/refresh",revoke:"/api/auth/revoke",dynamic:"/api/:microservice/:endpoint/:command"},t.hostUrl=process.env.host,t.urls={host:t.hostUrl,root:t.hostUrl+t.endpoints.baseUrl,api:t.hostUrl+t.endpoints.api,cart:t.hostUrl+t.endpoints.cart,inventory:t.hostUrl+t.endpoints.inventory,login:t.hostUrl+t.endpoints.login,logout:t.hostUrl+t.endpoints.logout,signup:t.hostUrl+t.endpoints.signup,account:t.hostUrl+t.endpoints.user,test:t.hostUrl+t.endpoints.test}},9701:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getDbOperation=void 0;const r=n(8395);t.getDbOperation=function(e,t,n){const o=r.MICROSERVICES[e];if(!o)throw new Error("ERROR: Invalid microservice");const i=o[t];if(!i)throw new Error("ERROR: Invalid endpoint");const a=i[n];if(!a)throw new Error("ERROR: Invalid command");return a}},2669:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleRoute=void 0;const o=r(n(8535)),i=n(9701);t.handleRoute=async function(e,t){const{microservice:n,endpoint:r,command:a}=e.params,{query:s,body:u}=e,c=Object.assign(Object.assign({},s),u),d=o.default.query(c);try{const e=(0,i.getDbOperation)(n,r,a),o=await e(d);t.json(o)}catch(e){await e,t.status(404).json(e.message)}}},2099:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t.sendFile("index.html",{root:"public"})}},4244:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(2553),o=n(4321);t.default={cartData:async function(e,t){try{const{email:n,token:o}=e.body.user,i=await(0,r.getCartByToken)(n,o);t.status(200).send(i)}catch(e){t.status(400).send(e)}},inventoryData:async function(e,t){try{const e=await(0,o.getInventory)();t.status(200).send(e)}catch(e){t.status(400).send(e)}}}},8823:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(6860)),i=r(n(2099)),a=n(5271),s=r(n(4244)),u=r(n(2730)),c=r(n(5634)),d=r(n(3986)),l=r(n(155)),f=r(n(6270)),y=r(n(6416)),p=r(n(7881)),h=r(n(3585)),m=n(2062),_=n(2669);r(n(5142)).default.config();const g=o.default.Router();g.post(m.endpoints.login,f.default.withGoogle,f.default.withToken,f.default.withPassword),g.post(m.endpoints.logout,d.default.withToken),g.post(m.endpoints.signup,l.default.withGoogle,l.default.withPassword),g.post(m.endpoints.user,y.default.fetchInfo),g.delete(m.endpoints.user,y.default.delete),g.post(m.endpoints.cart,p.default.token,s.default.cartData),g.put(m.endpoints.cart,p.default.token,u.default.cartData),g.delete(m.endpoints.cart,p.default.token,c.default.cartData),g.get(m.endpoints.inventory,s.default.inventoryData),g.get(m.endpoints.baseUrl,i.default),g.get(m.endpoints.test,a.testPage),g.post(m.endpoints.test,a.testPage),g.get(m.endpoints.api,h.default.ping),g.get(m.endpoints.dynamic,_.handleRoute),g.post(m.endpoints.dynamic,_.handleRoute),g.put(m.endpoints.dynamic,_.handleRoute),g.delete(m.endpoints.dynamic,_.handleRoute),t.default=g},5271:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.testPage=void 0,r(n(5142)).default.config(),t.testPage=function(e,t){const n=JSON.stringify({method:e.method,mode:process.env.mode,hostEnvironment:process.env.hostEnvironment});t.send(n)}},2730:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=n(3775),i=n(2553),a=n(56),s=n(921),u=r(n(6368));t.default={cartData:async function(e,t){var n,r;try{const a=(0,o.getValidValues)(e.body),c=a.user,d=a.cart,l=a.token;let f;u.default.cart(d),d._id=await(0,s.getCartId)(c,l);const y=a.item,p=null===(r=null===(n=null==e?void 0:e.body)||void 0===n?void 0:n.cart)||void 0===r?void 0:r.item_ids;y?f=await(0,i.updateCart)(d,y):p&&(f=await(0,i.setCart)(d,p)),t.status(200).send(f)}catch(e){const{error:n,message:r,code:o}=await(0,a.handleAsyncError)(e);t.status(o).send(r)}}}},3775:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toUsedProperties=t.getValidValues=void 0;const r=n(2433);function o(e){return function(t={},n,r,o){return void 0===n||n<0||e.includes(r)&&(t[r]=n),t}}t.getValidValues=function(e,t=n){t instanceof Array||(t=[t]);let n={};for(let i of t){const t=i.table;let a=i.properties;a instanceof Array||(a=[a]);const s=(0,r.reduce)(e[t],o(a));(0,r.isEmpty)(s)||(n[t]=s)}return(0,r.isEmpty)(n)?null:n},t.toUsedProperties=o},1026:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});const r=n(820),o=n(3051),i=n(6031),a=n(8112),s=n(6162),u=n(7320),c=n(8716),d=n(8639),l=n(5320),f=n(2648),y=n(3804),p=n(1962);t.default=class{constructor(){this.configureKnex=r.configureKnex.bind(this),this.configureMysql=o.configureMysql.bind(this),this.configureTypeorm=i.configureTypeorm.bind(this),this.configureSqlite=a.configureSqlite.bind(this),this.configureSqlKnex=s.configureSqlKnex.bind(this),this.configureSqlMysql=u.configureSqlMysql.bind(this),this.configureSqlTypeorm=c.configureSqlTypeorm.bind(this),this.sqlKnex=d.sqlKnex.bind(this),this.sqlTypeorm=l.sqlTypeorm.bind(this),this.sqlSqlite=f.sqlSqlite.bind(this),this.sqlSqliteFile=y.sqlSqliteFile.bind(this),this.sqlMysql=p.sqlMysql.bind(this)}}},820:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.configureKnex=void 0;const o=r(n(514));t.configureKnex=function(e){if(!e)throw new Error("ERROR: knexfile is required");const t=(0,o.default)(e);this.knex=t}},3051:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.configureMysql=void 0;const o=r(n(2744));t.configureMysql=function(e){const t=o.default.createConnection({host:e.host,user:e.user,password:e.password});this.mysql=t}},6162:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.configureSqlKnex=void 0,t.configureSqlKnex=function(){if(!this.knex)throw new Error("ERROR: knex must be configured");this.sql=this.sqlKnex.bind(this)}},7320:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.configureSqlMysql=void 0,t.configureSqlMysql=function(){if(!this.typeorm)throw new Error("ERROR: mysql must be configured");this.sql=this.sqlMysql.bind(this)}},8716:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.configureSqlTypeorm=void 0,t.configureSqlTypeorm=function(){if(!this.typeorm)throw new Error("ERROR: typeorm must be configured");this.sql=this.sqlTypeorm.bind(this),this.sql.initialized=async function(){this.typeorm.isInitialized||await this.typeorm.initialize()}.bind(this)}},8112:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.configureSqlite=void 0;const o=r(n(5890));t.configureSqlite=function(e,t){if(!e)throw new Error("ERROR: current working directory is required");if(!t)throw new Error("ERROR: filename is required");this.sqlite=new o.default(e+"/"+t),this.sqlite.cwd=e}},6031:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.configureTypeorm=void 0,t.configureTypeorm=function(e){if(!e)throw new Error("ERROR: AppDataSource is required");this.typeorm=e,this.typeorm.initialize(),this.typeorm.initialized=async function(){return this.typeorm.isInitialized?void 0:await this.typeorm.initialize()}.bind(this)}},8639:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sqlKnex=void 0,t.sqlKnex=async function(e,t){return(await this.knex.raw(e,t))[0]}},1962:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sqlMysql=void 0,t.sqlMysql=async function(e,t){return this.mysql.raw(e,t)}},2648:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sqlSqlite=void 0,t.sqlSqlite=async function(e,t=""){const n=this.sqlite.prepare(e).all();return console.log(t,"\n",n,"\n"),n}},3804:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.sqlSqliteFile=void 0;const o=r(n(7147));t.sqlSqliteFile=async function(e,t=this.sqlite.cwd){if(!t)throw new Error("ERROR: sqlite is not configured");const n=o.default.readFileSync(t+"/"+e);this.sqlite.exec(n.toString())}},5320:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.sqlTypeorm=void 0,t.sqlTypeorm=async function(e,t){return await this.typeorm.query(e,t)}},457:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const o=r(n(1026)),i=n(8739);class a extends o.default{constructor(){super(...arguments),this.configureMongodb=i.configureMongodb.bind(this)}}t.default=a},8739:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.configureMongodb=void 0;const r=n(5913),o=n(8013),i=n(8347);t.configureMongodb=function({connectionString:e,database:t}){const{protocol:n,port:a}=new URL(e);e=(0,i.isDockerEnvironment)()&&e.includes("localhost")?`${n}//host.docker.internal:${a}`:e,this.mongodb=(0,r.PromiseExtends)(async function(n,r){try{const r=new o.MongoClient(e);await r.connect();const i=r.db(t);n({client:r,db:i})}catch(e){console.error("ERROR: Unable to connect to mongodb"),await e,r(e)}}.bind(this)),this.mongodb.getCollection=e=>(0,r.PromiseExtends)(async function(t){await this.mongodb;const{db:n}=this.mongodb;t(n.collection(e))}.bind(this))}},5913:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PromiseExtends=void 0,t.PromiseExtends=function(e){const t=new Promise((function(n,r){function o(e){"object"==typeof e?(Object.assign(t,e),Object.setPrototypeOf(t,e)):Object.defineProperty(t,"value",{value:e}),n("Promise has been extended with new properties")}setTimeout((()=>e(o,r)),0)}));return t}},56:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleAsyncError=void 0;const o=r(n(7825));t.handleAsyncError=async function(e){const t=await e,n=t.message;let r=t.code;return("number"!=typeof r||r>=600)&&(r=o.default.error.serverError),{error:t,code:r,message:n}}},8347:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isDockerEnvironment=void 0;const o=r(n(7147));t.isDockerEnvironment=function(){return o.default.existsSync("/.dockerenv")}},7825:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default={success:{created:201,general:200,ok:200},error:{badRequest:400,conflict:409,forbiddenUser:403,general:400,unauthorized:401,unauthenticated:401,incorrectPassword:401,incorrectCredentials:401,serverError:500},redirect:{general:300}}},9577:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.hash=void 0;const o=r(n(6113));t.hash=function(e,t="sha256"){try{return o.default.createHash(t).update(e).digest("hex")}catch(e){return}}},182:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeEmptyValues=void 0;const r=n(2433);t.removeEmptyValues=function(e){if((0,r.isEmpty)(e))return null;let t=null;for(let n in e){const o=e[n];(0,r.isEmpty)(o)||(t?t[n]=o:t={[n]:o})}return t}},6935:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getHost=void 0;const r=n(8347);t.getHost=function(e="localhost"){return(0,r.isDockerEnvironment)()?"0.0.0.0":process.env.host||e}},2636:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getPort=void 0,t.getPort=function(e=8e3){return Number(process.env.PORT)||e}},8240:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isServerless=void 0,t.isServerless=function(){return"serverless"===process.env.hostEnvironment||"lambda"===process.env.hostEnvironment||process.env.AWS_LAMBDA_FUNCTION_NAME||process.env.AWS_LAMBDA_FUNCTION_VERSION}},2433:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.toCloneDeep=t.toClone=t.toFormEntries=t.toFields=t.toArrayish=t.timeout=t.temporarilyShrink=t.stringify=t.serialize=t.runCallback=t.removeFileExtension=t.removeElement=t.reduceObject=t.reduceArray=t.reduce=t.quoteValues=t.pressEnter=t.outValue=t.outProperty=t.outIndex=t.noHandler=t.matchValue=t.matchAllProperties=t.matchProperty=t.matchIndex=t.matchIsEqual=t.mapProperties=t.map=t.isURL=t.isObjectEmpty=t.isArrayEmpty=t.isEmpty=t.isChar=t.isHTMLfile=t.isDOMobjectReady=t.isUniqueValue=t.hash=t.getObjectProperties=t.getUniqueValues=t.getMultiArrayValue=t.getFormEntries=t.getCommandLineParameters=t.generateKey=t.floorOf=t.filterSort=t.find=t.convertToTextDocument=t.convertToHtmlDocument=t.combine=t.copyValuesOf=void 0;const o=n(6517),i=r(n(5666));async function a(e){let t=await fetch(e);return await t.text()}t.copyValuesOf=function(e,t){let n,r;for(n in e)try{r=e[n],t[n]=r}catch(e){console.log(`Couldn't copy ${n}:${r}`)}},t.combine=function(e,t){if(typeof e!=typeof t)throw Error("Cannot combine different types");return"string"==typeof e?`${e} ${t}`:e instanceof Array?[...e,...t]:"object"==typeof e?Object.assign(Object.assign({},e),t):void 0},t.removeElement=function(e,t,n){e.remove()},t.convertToHtmlDocument=async function(e){let t=await a(e),n=(new DOMParser).parseFromString(t,"text/html");return c(e)?Promise.resolve(n):Promise.reject(n)},t.convertToTextDocument=a,t.filterSort=function(e,t){return y(e,(function(e=[[],[]],n,r,o){const i=e[0],a=e[1];return t(n)?i.push(n):a.push(n),e}),[[],[]])},t.find=function(e,t,n=0){if(0!==n)throw new Error("find() startingIndex not yet implemented");e instanceof Array||(e=[e]),e.find(t)},t.floorOf=function(e,t){const n=e*t*10;return Math.trunc(n)/(10*t)};let s=0;function u(e,t,n){return n.indexOf(e)===t}function c(e){return/\.html$/.test(e)}function d(e){return e instanceof Array?l(e):e instanceof Object?f(e):null==e||""===e}function l(e){return e?0===e.length:e}function f(e){return 0===Object.keys(e).length}function y(e,t,n){return e?e instanceof Array?p(e,t,n):h(e,t,n):n}function p(e,t,n){if(!(e instanceof Array))throw new Error("An array was not passed to reduceArray()");let r=n;return e.forEach((function(e,n,o){r=t(r,e,n,o)})),0===e.length&&(r=t(r)),r}function h(e,t,n){if(e instanceof Array||"string"==typeof e||"number"==typeof e)throw new Error("An object was not passed to reduceObject()");let r=n;for(let n in e)r=t(r,e[n],n,e);return d(e)&&(r=t(r)),r}function m(e,t){const n=t;e.style.height=n.style.height,e.style.width=n.style.width}function _(e,t,n){const r={style:{height:e.style.height,width:e.style.width},offsetHeight:e.offsetHeight,offsetWidth:e.offsetWidth};return e.style.height=`${t}px`,e.style.width=`${n}px`,r}function g(e={},t,n,r){const o=t.name,i=t.value;return o&&(e[o]=i),e}t.generateKey=function(){return(new Date).getTime()+"-"+s++},t.getCommandLineParameters=function(){return process.argv.slice(2)},t.getFormEntries=function(e){return y(e.querySelectorAll("[name]"),g)},t.getMultiArrayValue=function e(t,n){if(d(t))return n;const r=t.shift();return e(t,n[r])},t.getUniqueValues=function(e){return e.filter(u)},t.getObjectProperties=function(e){let t;const n=[];for(t in e)n.push(t);return n},t.hash=function(e){try{if(!e)return;return i.default.SHA256(e).toString(i.default.enc.Hex)}catch(e){return}},t.isChar=function(e){return"string"==typeof e&&1===e.length},t.isUniqueValue=u,t.isDOMobjectReady=function e(t){if("loading"!==t.readyState)return t.removeEventListener("readystatechange",n),Promise.resolve(`${t} is ready`);function n(t){e(t.target)}t.addEventListener("readystatechange",n)},t.isHTMLfile=c,t.isEmpty=d,t.isArrayEmpty=l,t.isObjectEmpty=f,t.isURL=function(e){return/^http(s):\/\//i.test(e)},t.map=function(e,t){return e instanceof Array||(e=[e]),e.map(t)},t.mapProperties=function(e,t){if(!e)return[];const n=Object.getOwnPropertyNames(e);if(!n)return[];const r=[];return n.forEach((n=>{const o=t(e[n],n,e);r.push(o)})),r},t.matchIsEqual=function(e){return function(t,n,r){return(0,o.isEqual)(e,t)}},t.matchIndex=function(e){return function(t,n,r){return n===e}},t.matchProperty=function(e,t){return"string"==typeof e&&(e=[e]),function(n,r,o){let i=n;try{for(let t of e)i=i[t];return i===t}catch(e){return!1}}},t.matchAllProperties=function(e){return function(t,n,r){let o=!0;for(let n in e){const r=e[n];if(o=o&&t[n]===r,!o)return!1}return!0}},t.matchValue=function(e){return function(t,n,r){return t===e}},t.noHandler=function(){},t.outIndex=function(e){return function(t,n,r){return n!==e}},t.outProperty=function(e,t){return"string"==typeof e&&(e=[e]),function(n,r,o){let i=n;for(let t of e)i=i[t];return i!==t}},t.outValue=function(e){return function(t,n,r){return t!==e}},t.pressEnter=function(){return new Promise((function(e,t){process.stdin.resume(),process.stdin.once("data",(()=>(process.stdin.pause(),e())))}))},t.quoteValues=function(e){return e?e.map((e=>`"${e}"`)):e},t.serialize=function(e){const t={};for(let n in e){const r=e[n];t[n]=r}return t},t.stringify=function(e){return JSON.stringify(e,void 0," ")},t.temporarilyShrink=function(e){let t=e.parentElement,{offsetHeight:n,offsetWidth:r}=t||{};const o=_(t,n,r),i=e.offsetHeight,a=e.offsetWidth,s=_(e,i-.05*i,a-.05*a);setTimeout((function(){const n=s.offsetHeight,r=s.offsetWidth;_(e,n,r),m(e,s),m(t,o)}),100)},t.reduce=y,t.reduceArray=p,t.reduceObject=h,t.removeFileExtension=function(e){const t=e.split(".");return t.length>2&&t.pop(),t.join(".")},t.runCallback=function(e,t,n){e()},t.timeout=function(e){return new Promise((function(t){setTimeout((()=>t("Timeout complete")),e)}))},t.toArrayish=function(e={},t,n,r){return e[n]=t,e},t.toFields=function(e,t,n,r){e instanceof Array||(e=[]);const i=Object.keys(t),a=(0,o.difference)(i,e);return e.concat(a)},t.toFormEntries=g,t.toClone=function(e,t,n){return e},t.toCloneDeep=function(e,t,n){return(0,o.cloneDeep)(e)}},2139:e=>{e.exports=require("@sendgrid/mail")},5890:e=>{e.exports=require("better-sqlite3")},3582:e=>{e.exports=require("cors")},5666:e=>{e.exports=require("crypto-js")},5142:e=>{e.exports=require("dotenv")},6860:e=>{e.exports=require("express")},514:e=>{e.exports=require("knex")},6517:e=>{e.exports=require("lodash")},8013:e=>{e.exports=require("mongodb")},2744:e=>{e.exports=require("mysql")},3236:e=>{e.exports=require("reflect-metadata")},724:e=>{e.exports=require("serverless-http")},6113:e=>{e.exports=require("crypto")},7147:e=>{e.exports=require("fs")}},t={},n=function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}(9124),r=exports;for(var o in n)r[o]=n[o];n.__esModule&&Object.defineProperty(r,"__esModule",{value:!0})})();